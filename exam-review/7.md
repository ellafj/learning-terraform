# Implement and maintain state

## Backends
Each Terraform workspace has an associated backend that defines how operatopns are executed and where persisten data such as the Terraform state are stored. Certain backends support multiple named workspaces, allowing multiple states to be associated with a single configuration.

## Workspaces commands
Listing the workspaces: `terraform workspace list`

Create a new workspace: `terraform workspace new <name>`

Show the current workspace: `terraform workspace show`

Switch workspace: `terraform workspace select <workspace name>`

Delete workspace: `terraform delete <workspace name>`

NB! You cannot delete the default workspace.

## Use of workspaces
Workspaces are great when you want to create a parallel, distinct copy of a set of infrastructure in order to test a set of changes before modifying the main production infrastructure.

## When working with workspaces
We access the current workspace in the configuration files through `${terraform.workspaces}`. 

When using workspaces, Terraform saves the state file for the local state in `terraform.tfstate.d`. For rthe remote state, the workspaces are stored directly in the configured backend.

## Renaming resources in a state file

```
terraform state mv 'packet_device.worker' 'packet_device.helper'
```

